<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Realizar Pedido</title>
    <link rel="stylesheet" href="../css/font.css">
    <link rel="stylesheet" href="../css/index.css">
    <link rel="stylesheet" href="../css/pedido.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <script type="text/javascript" src="https://gc.kis.v2.scr.kaspersky-labs.com/FD126C42-EBFA-4E12-B309-BB3FDD723AC1/main.js?attr=6uDF89wgZa1w1XhqYMzmOL7wJyED4c5coRJvtisMlGDW0bc6NSQOwi9R9hY76bq6_rxsSAkSHWHiHK62O75hiHZlSa4Ths1Fnmuoq4ELOpeKuIJe1beyIaZnhanN9mq17b9B9ytOBTGRSF7WQGxLJzvE0mOIIMpXodLOkedcUoy_4bP91i0iGoUYqFIk1bRhKYA7egjvzc6hl9uG-gVu-XAFc8dBOfUtoyqf1UToRyWSCQagSfgEo1wFmErkxaUD7y0szsMwJ3TXP3IaUAR2QvJG4c-6KD_Uua0kxzYJAKW3qyVhKHNemKUcyrZJcvTRu9p99ii2FLGhQ77O0BLBsxGWgupeEn1OxO1RYpdOB1gHzuquCg5v56parcAamy4pNB-mwiWYCXr6h98zrHTRxO0StsVz3Jlkqb4r4mQF8TBwyAT3LFlqd9J5bQQbM0U2LrAUfLfDgCDDaW-nOMjdG_2M_1kwWizTjdnCaYxCNy6vRkLJjqPwy01RtMFjNFNsf0kcmVbPLjRmxXocAWin7BZxeqPH2gNOwJ1wKjf-boS-wHUbL8A4aokNY-_6gIsPFMXC9HZFtIoroKN9DkDbBHBHJ7DEKHxKVi0oRyQmaCRQML8ESnL9ebVvZLqb8yuUkXmsbQPuhyJEB6EohJ1EkieYV0Fd9po0Vn-U5pF6xRbpEtPatyXXFtt4V1i3w5tc4AZ2K_faPkHQxecLDkM5Pua-UA0jNGM9UtdzSb20KlkgxZCawawBAjwvZkJtUrvuY0KqTNUahbjytAmJxiobbFB9qlLDgB27-NxsJb5jk0NB8yyv2GBK7GH8HQbxqNAguFwTEWt2joJVPkMtod8S8YbaoZuI7N6fVIG3a76245tPz2IPqRnTONqI1xpO8kq5jglWPierkTrVOTauZWu0eqNLoZu1JrZBYnEH_Ovw2CvvNrZGFc4Rs4ePq8klZw3tMUgxpj-c2rrFsDU_-YtlbiHvI9HoqK9HhcPc8fsqfYz-_tSTopqvYmFY8r1O8nePOlGMINecZuDJ-g4FfKtGJN81DopyC1-kDgb3gscJtFwVd7ih5lhsOxasxB_x4df46FsqE5tH-0jUPOYqNTPFY2Wgva81w1LA-06Z-UcKvwagsm8hYDhm_TnX_qGmxd3soeaBpmlzUR8FdyJmtHmnNajz16N7Fej1eA7ZC9tNiciy0VJ-K9TIdshJZ1_fb6vm3Ucbibm4JZQpTCpNM_-KujVpMKOwc3BBvTB0qWoylgWFknphhi0D-9trQiguHKCfdt-nYArjeJMvBR37DYOGINlOa9hJYPVrrT187wP0Kjdm29WFW07MrwRAH5kzlSxBAKeeqT9_FTgCU-aBn9ncl_WITk33aOmLlFO8QFPXm7cdabkP1hDx7Nzo8KUpitq6U8yFsDZgRz2WV0GW4E6Az89bgQlDvv1q0_ju26GTUNeXoYA-mny8cSY6imuP-5oS0NlSoTTVyHqyW7MZO-nJbRr5S-pd3ZNo8C6nYdLK9ZwfqWLOSTMDFy7wp0H62aD8-cdcRpHNCibr9wBEVI20MOo0U6iZ8VbQI0Z5WMP2QTYGnTKUinjcZ2guB5NVwV78T1ZqUkFpXeHSX4LSvmVOlY9iC7YRZtiEyt-o50Dwlr-b7H6-J6un3SsR0WoNv6GZ5HsVVk1lktpXnXlmRAESoe-2aTZBZRP7gN2fD3aWN4dXuBG89uDRROKb9Jx4-K1HsOPlGiMwfYaB4q5ZeOT_r5sEuGs21_JPpieGyUkfWl91j9HnVl3Z9fyP4y2jFXMl-tII05qwhDzp9CqQuPXfdUyuAE76BHtVXgzt1VQs0Ja13unEO-gcyR0leAFQpudQo5Rs_rFtKMN4JV7maz5RyM3ezqJ12Y109z0onKdAS_b40EpPc0dYKu2t50eH2jYCVWBA-tUZYnUtdbfQPAIERvZyVobGRRXEQq9_75PcJ_5NLb4Os-dUSeR7hUNRn8aWhkrKJFcGZvpIGeUq1yFPA6vWoDKoc7-nAFWwQNJy1FA" charset="UTF-8"></script><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
</head>
<body class="container">
    <header>
        <nav class="mt-2 navbar navbar-expand-sm">
            <div class="container-fluid">
              <a class="navbar-brand" href="../index.html">
                <img src="../img/saltykitty.png" class="logo">
            </a>
              <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
              </button>
              <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="../index.html">Produtos</a>
                  </li>
                </ul>
              </div>
            </div>
          </nav>
    </header>
    
    <section class="p-3" id="head">
      <div class="d-flex flex-column">
          <div class="row d-flex mb-3 pb-3" style="border-bottom: 1px solid #a02c55;">
              <div style="width: 80%;">
                  <h2>Pedido</h2>
                  <span>Escolha os ingredientes</span>
              </div>
              <div class="d-flex justify-content-end mt-4" style="width: 19%;">
                  <div id="oDivConta" class="oDivConta p-4">
                      <div class="mb-4">
                          <span>Olá, <b>Usuário</b></span>
                      </div>
                      <div class="mb-1">
                          <span class="optC">Minha conta</span>
                      </div>
                      <div>
                          <span style="cursor: pointer;" id="btnSair" class="optC">Sair</span>
                      </div>
                  </div>
                  
              </div>
          </div>
    <div id="ingredients-list">
      <div class="ingredient">
        <label for="frango">Frango</label>
        <input type="checkbox" id="frango" name="ingredient" value="frango" checked>
      </div>
      <div class="ingredient">
        <label for="milho">Milho</label>
        <input type="checkbox" id="milho" name="ingredient" value="milho" checked>
      </div>
      <div class="ingredient">
        <label for="tomate">Tomate</label>
        <input type="checkbox" id="tomate" name="ingredient" value="tomate" checked>
      </div>
      <div class="ingredient">
        <label for="maionese">Maionese</label>
        <input type="checkbox" id="maionese" name="ingredient" value="maionese" checked>
      </div>
      <div class="ingredient">
        <label for="azeitona">Azeitona</label>
        <input type="checkbox" id="azeitona" name="ingredient" value="azeitona" checked>
      </div>
      <div class="ingredient">
        <label for="cenoura">Cenoura</label>
        <input type="checkbox" id="cenoura" name="ingredient" value="cenoura" checked>
      </div>
      <div class="ingredient">
        <label for="ervilha">Ervilha</label>
        <input type="checkbox" id="ervilha" name="ingredient" value="ervilha" checked>
      </div>
      <div class="ingredient">
        <label for="queijo-ralado">Queijo ralado</label>
        <input type="checkbox" id="queijo-ralado" name="ingredient" value="queijo ralado" checked>
      </div>
    </div>
    <div class="nomeRequest mt-2" id="nomeRequest">
      Insira seu nome para finalizar o pedido<br>
      <input type="text" id="nome" class="form-control mt-2" style="width: 400px;">
      <span id="nomeObr" style="display: none"><small>Este campo é obrigatório</small></span>
      <button class="button mt-5" id="button" onclick="alterView()">Realizar Pedido</button>
    </div>
    
    

    <div class="realized justify-content-center align-items-center" id="realized">
      <img src="../img/checked.png" alt="">
      <h2>Pedido realizado com sucesso!</h2>
    </div>
    <script src="pedido.js"></script>   
</body>
  <script>
      ici = document.getElementById("icI")
      divConta = document.getElementById("oDivConta")
      i=0
  
      function mudar(){
          if(divConta.style.display != "block"){
              divConta.style.display = "block"
          }
          else{
              divConta.style.display = "none"
          }
  
      }
  </script>
  
  <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.19.1/firebase-app.js";
      import { getDatabase, set, ref, push, child, update, onValue} from "https://www.gstatic.com/firebasejs/9.19.1/firebase-database.js";
      import { getAnalytics} from "https://www.gstatic.com/firebasejs/9.19.1/firebase-analytics.js";
      import { getAuth, signOut}from "https://www.gstatic.com/firebasejs/9.19.1/firebase-auth.js";
      // TODO: Add SDKs for Firebase products that you want to use
      // https://firebase.google.com/docs/web/setup#available-libraries
    
      // Your web app's Firebase configuration
      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      const firebaseConfig = {
        apiKey: "AIzaSyClbeYWlsKsWVAC1QQf8K9W22kNrjTMzng",
        authDomain: "roginookashi.firebaseapp.com",
        projectId: "roginookashi",
        storageBucket: "roginookashi.appspot.com",
        messagingSenderId: "76735896471",
        appId: "1:76735896471:web:5df7cfee5a41411dae02d2",
        measurementId: "G-CRCX9RJ6DX"
      };
    
      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);
      const database = getDatabase(app);
      const auth = getAuth();

      const checkboxes = document.getElementsByName('ingredient')
  
      btnSair.addEventListener('click',(e)=>{
          signOut(auth).then(() => {
          alert("Logout efetuado")
          window.location.replace("login.html")
          // Sign-out successful.
      }).catch((error) => {
          // An error happened.
          alert(error.message)
      });
      })
      
      button.addEventListener('click', (e) =>{
        if(document.getElementById('nome').value != ""){
            for(i=4;i<checkboxes.length;i++){
              if(checkboxes[i].checked ){
                checkboxes[i].value = "Sim"
              }else{
                checkboxes[i].value = "Não"
              }
            }

            var nome = document.getElementById("nome").value
            var produto = "Bolo Salgado"
            var A = checkboxes[4].value
            var C = checkboxes[5].value
            var E = checkboxes[6].value
            var Q = checkboxes[7].value

            const userId = push(child(ref(database), 'pedidos')).key

            set(ref(database, 'pedidos/' + userId), {
            nome: nome,
            produto: produto,
            A: A,
            C: C,
            E: E,
            Q: Q,
        });
      }else{
        document.getElementById("nomeObr").style.display = "block"
      }
    })

    getData.addEventListener('click',(e) => {
        $("#table td").remove();

        var rowNum = 0;
        const dbRef = ref(database, 'pedidos/');

        onValue(dbRef, (snapshot) => {
        snapshot.forEach((childSnapshot) => {
            const childKey = childSnapshot.key;
            const childData = childSnapshot.val();
            // ...
            rowNum += 1
            var row = "<tr><th>" +rowNum+ "</th><td>" + childData.nome + "</td><td>" + childData.produto + "</td><td>" + childData.A + "</td><td>" + childData.C + "</td><td>" + childData.E + "</td><td>" + childData.Q + "</td></tr>"

            $(row).appendTo('#table')
        });
        }, {
        onlyOnce: true
        });
    })
  
</script>
</html>